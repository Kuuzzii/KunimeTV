<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Watch - KuNime</title>
  <link rel="stylesheet" href="watch.css" />
  <!-- Moved JS inline for this example so you can easily see code -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const movieId = urlParams.get('id');
      const mediaType = urlParams.get('type');
      const episode = urlParams.get('episode'); // may be null

      // Elements
      const backBtn = document.getElementById('back-btn');
      const playBtn = document.getElementById('play-btn');
      const serverSelect = document.getElementById('server-select');
      const episodeBtn = document.getElementById('episode-btn');

      // TODO: Load movie/tv show data based on movieId and mediaType (not shown here)

      backBtn.addEventListener('click', () => {
        window.history.back();
      });

      playBtn.addEventListener('click', () => {
        // Play button logic here
        // Use selected server and other parameters
        // Example redirection or player update:
        alert(`Play clicked!\nID: ${movieId}\nType: ${mediaType}\nServer: ${serverSelect.value}${episode ? `\nEpisode: ${episode}` : ''}`);
      });

      episodeBtn.addEventListener('click', () => {
        let epNum = prompt('Enter episode number:', episode || '1');
        if (epNum) {
          epNum = epNum.trim();
          if (/^\d+$/.test(epNum) && parseInt(epNum) > 0) {
            // Construct new URL with episode parameter
            const baseUrl = window.location.pathname;
            const searchParams = new URLSearchParams(window.location.search);
            searchParams.set('episode', epNum);
            // Redirect to same page but with updated episode
            window.location.href = `${baseUrl}?${searchParams.toString()}`;
          } else {
            alert('Please enter a valid positive number for the episode.');
          }
        }
      });
    });
  </script>
</head>
<body>
  <header class="navbar">
    <div class="logo">
      <img src="https://static.vecteezy.com/system/resources/previews/016/699/663/original/graffiti-letter-k-premium-illustration-vector.jpg" alt="KuNime Logo" />
      <span>KuNime</span>
    </div>
    <button id="back-btn" type="button" class="back-button">&#8592; Back</button>
  </header>

  <main class="movie-container">
    <div id="movie-backdrop" class="movie-backdrop">
      <div class="movie-details">
        <div class="movie-poster">
          <img id="movie-poster" src="" alt="Movie Poster" />
        </div>
        <div class="movie-info">
          <h1 id="movie-title"></h1>
          <p class="movie-meta">
            <span id="movie-release-date"></span> â€¢
            <span id="movie-runtime"></span>
          </p>
          <div id="movie-genres" class="movie-genres"></div>
          <p id="movie-overview"></p>
          <div class="movie-actions">
            <button id="play-btn" type="button" class="action-btn play-btn">&#9658; Play</button>
            <select id="server-select" class="action-btn" aria-label="Select Streaming Server">
              <option value="vidsrc.cc">Vidsrc.cc</option>
              <option value="vidsrc.me">Vidsrc.me</option>
              <option value="videasy.net">Videasy.net</option>
            </select>
            <button id="episode-btn" class="action-btn" type="button" aria-label="Select Episode">Episode</button>
          </div>
        </div>
      </div>
    </div>

    <div class="video-container">
      <iframe id="movie-video" frameborder="0" allowfullscreen loading="lazy" title="Streaming Video Player"></iframe>
    </div>
  </main>
</body>
</html>
